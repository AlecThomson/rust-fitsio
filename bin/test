#!/bin/bash
set -e
set -x

RUST_VERSION=${RUST_VERSION:-stable}

run_cargo() {
    cargo +${RUST_VERSION} $*
}

TEST_TO_RUN=${TEST_TO_RUN:all}

run_test() {
    if [ "${TEST_TO_RUN}" = "$1" ] || [ "{TEST_TO_RUN}" = "all" ]; then
        bash "./bin/test_$1"
    fi
}

run_test basic
run_test bindgen
run_test full_example
run_test feature_array
run_test feature_fitsio_src
run_test book_examples
